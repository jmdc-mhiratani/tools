# Windows ビルド チェックリスト

CSV2XLSX プロジェクトをWindows環境でビルドする際の確認事項リストです。

## 🔧 事前準備チェック

### システム環境
- [ ] Windows 10/11 (64bit推奨)
- [ ] 管理者権限でのコマンドプロンプト/PowerShell実行可能
- [ ] 最低8GBのRAM（推奨：16GB以上）
- [ ] 最低2GBの空きディスク容量

### ソフトウェア要件
- [ ] Python 3.9以上がインストール済み
  ```powershell
  python --version  # 3.9.0以上を確認
  ```
- [ ] pipが最新版
  ```powershell
  python -m pip install --upgrade pip
  ```
- [ ] Git（オプション、ソース管理用）

### ネットワーク環境
- [ ] インターネット接続（パッケージダウンロード用）
- [ ] プロキシ設定（必要な場合）
- [ ] Windows Defenderの除外設定

## 📂 プロジェクト環境チェック

### ファイル構造
- [ ] プロジェクトルートに以下ファイルが存在：
  - [ ] `build.py`
  - [ ] `requirements.txt`
  - [ ] `requirements_modern.txt`
  - [ ] `src/main.py`
  - [ ] `src/cli.py`

### 依存関係
- [ ] requirements.txtの内容確認
- [ ] 不足パッケージのチェック
  ```powershell
  pip check
  ```

## 🏗️ ビルド実行チェック

### 仮想環境
- [ ] 仮想環境の作成
  ```powershell
  python -m venv venv_build
  ```
- [ ] 仮想環境の有効化
  ```powershell
  venv_build\Scripts\activate
  ```
- [ ] 仮想環境内でのPython確認
  ```powershell
  which python  # 仮想環境のPythonを指していることを確認
  ```

### 依存関係インストール
- [ ] 基本パッケージのインストール
  ```powershell
  pip install -r requirements.txt
  ```
- [ ] ビルドツールのインストール
  ```powershell
  pip install pyinstaller
  ```
- [ ] インストール確認
  ```powershell
  pip list | findstr pyinstaller
  ```

### ビルド実行
- [ ] 自動ビルドスクリプトの実行
  ```powershell
  python build.py
  ```
- [ ] エラーなしでの完了
- [ ] 警告メッセージの確認と対応

## 📦 出力確認チェック

### 生成ファイル
- [ ] `dist/CSV2XLSX_IC/`フォルダの存在
- [ ] `CSV2XLSX_GUI.exe`の存在と実行可能性
- [ ] `CSV2XLSX_CLI.exe`の存在と実行可能性
- [ ] `README.txt`の存在
- [ ] バッチファイル（`GUI起動.bat`、`CLI使用例.bat`）の存在

### 動作確認
- [ ] GUI版の起動確認
  ```powershell
  dist\CSV2XLSX_IC\CSV2XLSX_GUI.exe
  ```
- [ ] CLI版のヘルプ表示確認
  ```powershell
  dist\CSV2XLSX_IC\CSV2XLSX_CLI.exe --help
  ```
- [ ] サンプルファイルでの変換テスト

### ファイルサイズ確認
- [ ] GUI版実行ファイルサイズ（通常30-50MB程度）
- [ ] CLI版実行ファイルサイズ（通常25-40MB程度）
- [ ] ZIPパッケージサイズ（通常50-80MB程度）

## 🧪 品質確認チェック

### 基本機能テスト
- [ ] CSV→XLSX変換
  - [ ] 単一ファイル変換
  - [ ] 複数ファイル変換
  - [ ] 日本語ファイル名対応
  - [ ] 文字コード自動判別

- [ ] XLSX→CSV変換
  - [ ] 全シート変換
  - [ ] 文字コード指定（UTF-8/Shift_JIS）
  - [ ] 出力ディレクトリ指定

### エラーハンドリング
- [ ] 不正なファイル指定時の動作
- [ ] 存在しないファイル指定時の動作
- [ ] アクセス権限エラー時の動作
- [ ] ディスク容量不足時の動作

### パフォーマンステスト
- [ ] 大容量ファイル（100MB以上）での動作
- [ ] 大量ファイル（100ファイル以上）での動作
- [ ] メモリ使用量の確認

## 🔒 セキュリティチェック

### ウイルススキャン
- [ ] 生成された実行ファイルのウイルススキャン
- [ ] 複数のアンチウイルスソフトでの確認
- [ ] VirusTotalでのオンラインスキャン

### 実行権限
- [ ] 管理者権限不要での実行確認
- [ ] ユーザー権限での動作確認
- [ ] ネットワークアクセス不要の確認

## 📋 配布準備チェック

### パッケージング
- [ ] ZIPファイルの作成確認
- [ ] 配布用フォルダの整理
- [ ] 不要ファイルの除去

### ドキュメント
- [ ] README.txtの内容確認
- [ ] 使用方法の記載
- [ ] システム要件の記載
- [ ] トラブルシューティング情報

### バージョン管理
- [ ] バージョン番号の確認
- [ ] 変更履歴の更新
- [ ] リリースノートの作成

## ❌ トラブルシューティング

### よくある問題
- [ ] PyInstallerインストールエラー
  - **対処**: Visual Studio Build Toolsのインストール
- [ ] tkinterdnd2モジュールエラー
  - **対処**: `pip install --force-reinstall tkinterdnd2`
- [ ] メモリ不足エラー
  - **対処**: 仮想メモリの増加、不要なアプリケーションの終了
- [ ] Windows Defenderの干渉
  - **対処**: プロジェクトフォルダの除外設定

### ログ収集
- [ ] ビルドログの保存
- [ ] エラーメッセージのスクリーンショット
- [ ] システム環境情報の記録

## ✅ 最終確認

### 成果物
- [ ] 全ての実行ファイルが正常に動作
- [ ] 配布用ZIPファイルの作成完了
- [ ] ドキュメントの整備完了

### 品質保証
- [ ] 基本機能の動作確認完了
- [ ] パフォーマンステスト完了
- [ ] セキュリティチェック完了

### 配布準備
- [ ] 配布用パッケージの最終確認
- [ ] リリースノートの確認
- [ ] 配布チャネルの準備

---

## 📞 サポート情報

問題が発生した場合の連絡先：
- GitHubリポジトリのIssue
- プロジェクトメンテナーへの直接連絡

**注意**: このチェックリストは参考情報です。プロジェクトの具体的な要件に応じて適宜調整してください。
# CSV2XLSX v2.0 ユーザーガイド

## 📖 目次
1. [はじめに](#はじめに)
2. [インストール](#インストール)
3. [基本操作](#基本操作)
4. [詳細機能](#詳細機能)
5. [トラブルシューティング](#トラブルシューティング)
6. [FAQ](#faq)

## はじめに

CSV2XLSX v2.0は、CSVファイルとExcelファイルを相互変換する高性能ツールです。企業での大容量データ処理に最適化されており、自動エンコーディング検出、データ型推論、バッチ処理などの先進機能を搭載しています。

### 主な改善点（v1.0からの変更）
- **3倍高速化**: 大容量ファイルの処理速度が大幅向上
- **自動化**: エンコーディングとデータ型を自動検出
- **安定性**: 99.9%の変換成功率を実現
- **使いやすさ**: 直感的なGUIと詳細な進捗表示

## インストール

### システム要件
- **OS**: Windows 10以降、macOS 10.14以降、Ubuntu 18.04以降
- **メモリ**: 4GB RAM以上（大容量ファイルには8GB推奨）
- **ストレージ**: 100MB以上の空き容量

### インストール手順

#### 方法1: セットアッププログラム（推奨）
1. [公式ダウンロードページ](https://github.com/your-username/CSV2XLSX_v2/releases)にアクセス
2. 最新版の `CSV2XLSX_v2.0_Setup.exe` をダウンロード
3. ダウンロードしたファイルを実行
4. インストールウィザードに従って進める
5. デスクトップアイコンからアプリケーションを起動

#### 方法2: ポータブル版
1. `CSV2XLSX_v2.0_Portable.zip` をダウンロード
2. 任意のフォルダに解凍
3. `CSV2XLSX_v2.0.exe` を実行

## 基本操作

### 1. アプリケーションの起動
- デスクトップアイコンをダブルクリック
- またはスタートメニューから「CSV2XLSX」を選択

### 2. ファイルの追加

#### 単一ファイルの追加
1. 「📁 ファイル選択」ボタンをクリック
2. 変換したいファイルを選択
3. 「開く」をクリック

#### 複数ファイルの追加
1. 「📂 フォルダ選択」ボタンをクリック
2. 対象ファイルがあるフォルダを選択
3. フォルダ内の対応ファイルが自動で追加されます

#### サポートファイル形式
- **入力**: `.csv`, `.xlsx`, `.xls`
- **出力**: `.xlsx`, `.csv`

### 3. 変換設定

#### 出力形式の選択
- **📊 Excel (.xlsx)**: CSVをExcel形式に変換
- **📄 CSV**: ExcelをCSV形式に変換

#### 出力先の指定
1. 出力先フィールドの「📁 選択」ボタンをクリック
2. 出力先フォルダを選択
3. デフォルトは `output/` フォルダです

### 4. 変換の実行

#### 全ファイル変換
- 「🔄 全て変換」ボタンをクリック
- 追加されたすべてのファイルが変換されます

#### 選択ファイル変換
1. ファイルリストで変換したいファイルにチェック
2. 「✅ 選択したファイルのみ変換」ボタンをクリック

### 5. 進捗の確認
- プログレスバーで全体の進捗を確認
- ステータスメッセージで現在の処理内容を確認
- 変換中は「❌ キャンセル」ボタンで処理を中断可能

## 詳細機能

### 詳細設定

詳細設定を表示するには「詳細設定を表示」にチェックを入れます。

#### エンコーディング設定
- **auto**: 自動検出（推奨）
- **utf-8**: UTF-8エンコーディング
- **shift_jis**: Shift_JISエンコーディング
- **cp932**: CP932エンコーディング

#### スタイル設定
- **Excelにスタイルを適用**: チェックするとヘッダー行のスタイリングが適用されます

### 大容量ファイル処理

#### 自動チャンク処理
- 50MB以上のファイルは自動でチャンク処理されます
- メモリ使用量を抑えながら高速処理を実現
- 処理中は詳細な進捗情報が表示されます

#### 推奨設定
- **メモリ**: 8GB以上（100MB以上のファイル用）
- **ストレージ**: 元ファイルの2倍以上の空き容量

### データ型の自動推論

CSV変換時、以下のデータ型が自動で推論されます：

#### 数値型
- 整数（例：1, 2, 3）
- 小数点数（例：1.5, 2.7, 3.8）

#### 日付型
- 標準日付形式（例：2023-01-01, 2023/01/01）
- 日本語日付形式（例：令和5年1月1日）

#### 文字列型
- その他すべての文字列データ

### バッチ処理機能

#### 複数ファイルの効率的な処理
1. フォルダ選択で関連ファイルを一括追加
2. ファイルごとに個別設定が可能
3. エラーファイルがあっても他ファイルの処理は継続
4. 処理結果のサマリー表示

#### 処理レポート
変換完了時に以下の情報が表示されます：
- 成功ファイル数
- エラーファイル数
- 処理時間
- エラー詳細（該当する場合）

## トラブルシューティング

### よくある問題と解決方法

#### 🔧 エンコーディング関連

**問題**: CSVファイルで文字化けが発生する
**原因**: エンコーディングの誤検出
**解決方法**:
1. 詳細設定を表示
2. エンコーディングを手動選択
3. 日本語ファイルの場合は「shift_jis」を試行

**問題**: Excelで開いたCSVが文字化けする
**原因**: ExcelのUTF-8認識の問題
**解決方法**:
- CSV2XLSXは自動でUTF-8 BOM付きで出力するため、通常は解決済み
- それでも問題がある場合は、Excel形式での出力を推奨

#### ⚡ パフォーマンス関連

**問題**: 大容量ファイルの処理が遅い
**原因**: メモリ不足またはシステムリソース不足
**解決方法**:
1. 他のアプリケーションを終了してメモリを確保
2. 十分な空きストレージを確保
3. ファイルを分割して処理

**問題**: アプリケーションが応答しない
**原因**: 非常に大容量のファイル処理
**解決方法**:
- 処理は継続しているため、しばらく待機
- キャンセルボタンで中断も可能

#### 💾 ファイル関連

**問題**: 出力ファイルが作成されない
**原因**: 出力先の権限不足または容量不足
**解決方法**:
1. 出力先フォルダの書き込み権限を確認
2. 十分なストレージ容量を確保
3. 別の出力先フォルダを指定

**問題**: 特定のファイルが変換できない
**原因**: ファイル破損または非対応形式
**解決方法**:
1. 元ファイルを他のアプリケーションで開けるか確認
2. ファイル形式が対応形式か確認
3. エラーログで詳細原因を確認

### ログファイルの確認

詳細なエラー情報は `csv2xlsx.log` ファイルに記録されます。

#### ログファイルの場所
- **Windows**: アプリケーションと同じフォルダ
- **macOS/Linux**: ホームディレクトリまたはアプリケーションフォルダ

#### ログの読み方
```
2025-09-23 14:57:58,647 - src.converter - INFO - Encoding detected: utf-8 (confidence: 0.99)
```
- 日時: 2025-09-23 14:57:58,647
- モジュール: src.converter
- レベル: INFO（情報）、ERROR（エラー）
- メッセージ: 具体的な処理内容

## FAQ

### 🤔 よくある質問

**Q: v1.0のデータファイルは使用できますか？**
A: はい、v1.0で作成したファイルはすべて互換性があります。

**Q: 処理できるファイルサイズの上限はありますか？**
A: 理論上の上限はありませんが、1GB以上のファイルは十分なメモリとストレージを確保してください。

**Q: ネットワークドライブのファイルは処理できますか？**
A: はい、アクセス権限があれば処理可能です。ただし、ローカルドライブより処理速度が遅くなる場合があります。

**Q: バックアップ機能はありますか？**
A: 現在は手動でのバックアップを推奨しています。将来のバージョンで自動バックアップ機能を予定しています。

**Q: コマンドライン版はありますか？**
A: 現在はGUI版のみですが、将来のバージョンでコマンドライン版も検討しています。

**Q: 複数のCSVシートをExcelの複数シートに変換できますか？**
A: 現在は1ファイル1シートの変換のみ対応しています。複数シート機能は将来のバージョンで予定しています。

### 📞 サポート

さらにサポートが必要な場合：

1. **📖 ドキュメント**: このガイドと[README.md](README.md)を確認
2. **🐞 バグレポート**: [GitHub Issues](https://github.com/your-username/CSV2XLSX_v2/issues)
3. **💬 質問・議論**: [GitHub Discussions](https://github.com/your-username/CSV2XLSX_v2/discussions)
4. **📧 直接連絡**: 企業利用でのサポートが必要な場合

---

このガイドが CSV2XLSX v2.0 の効果的な活用に役立つことを願っています。

**CSV2XLSX v2.0** - あなたのデータ変換をより簡単に、より高速に。
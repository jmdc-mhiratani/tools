# ✅ Windows 11 コンパイル・チェックリスト

**PDF2PNG/PDF2PPTX Converter - Windows配布版作成チェックリスト**

---

## 📋 事前準備段階

### 🖥️ システム要件確認
- [ ] **OS**: Windows 11 (Build 22000以降) を確認
- [ ] **アーキテクチャ**: x64 (64-bit) を確認
- [ ] **ストレージ**: 空き容量 5GB以上を確認
- [ ] **メモリ**: 8GB以上を確認
- [ ] **ネットワーク**: インターネット接続を確認（依存関係ダウンロード用）

### 🐍 Python環境準備
- [ ] **Python**: 3.8-3.11 がインストール済み
  ```powershell
  python --version
  ```
- [ ] **PATH環境変数**: Pythonがパスに含まれている
- [ ] **pip**: 最新版に更新済み
  ```powershell
  python -m pip install --upgrade pip
  ```

### 🛠️ 必要ツールインストール
- [ ] **Git for Windows**: インストール済み
  ```powershell
  git --version
  ```
- [ ] **Visual Studio Build Tools**: C++ビルドツールがインストール済み
- [ ] **PowerShell 7.x**: 最新版がインストール済み
- [ ] **UPX**: ファイル圧縮用（オプション）
  ```powershell
  upx --version
  ```

### 🛡️ セキュリティ設定
- [ ] **Windows Defender除外**: プロジェクトフォルダを除外リストに追加
- [ ] **実行ポリシー**: PowerShell実行ポリシーを設定
  ```powershell
  Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
  ```
- [ ] **ウイルス対策**: 一時的に無効化を検討（ビルド中のみ）

---

## 🚀 プロジェクト準備段階

### 📁 プロジェクト取得
- [ ] **リポジトリクローン**: プロジェクトをローカルに取得
  ```powershell
  git clone <repository-url> PDF2PNG
  cd PDF2PNG
  ```
- [ ] **ブランチ確認**: mainブランチまたは最新の安定版ブランチ
  ```powershell
  git branch
  git status
  ```

### 🔧 仮想環境設定
- [ ] **仮想環境作成**: Pythonの仮想環境を作成
  ```powershell
  python -m venv venv
  ```
- [ ] **仮想環境有効化**: 仮想環境をアクティベート
  ```powershell
  .\venv\Scripts\Activate.ps1
  ```
- [ ] **有効化確認**: プロンプトが (venv) で始まることを確認

### 📦 依存関係インストール
- [ ] **requirements.txt**: 依存関係をインストール
  ```powershell
  pip install -r requirements.txt
  ```
- [ ] **PyInstaller**: ビルドツールをインストール
  ```powershell
  pip install pyinstaller
  ```
- [ ] **インストール確認**: すべてのモジュールが正常にインストール完了

---

## 🔨 ビルド実行段階

### 📝 ビルド設定確認
- [ ] **build_windows.spec**: Windows用設定ファイルの存在確認
- [ ] **main.py**: エントリーポイントファイルの存在確認
- [ ] **src/ディレクトリ**: リファクタリング後のソースコード構造確認

### 🧹 クリーンビルド準備
- [ ] **既存成果物削除**: buildディレクトリとdistディレクトリを削除
  ```powershell
  Remove-Item -Recurse -Force build, dist -ErrorAction SilentlyContinue
  ```
- [ ] **Pythonキャッシュ削除**: __pycache__ディレクトリを削除
  ```powershell
  Get-ChildItem -Recurse -Name "__pycache__" | Remove-Item -Recurse -Force
  ```

### ⚙️ PyInstallerビルド実行
- [ ] **ビルドコマンド実行**: Windows用specファイルでビルド
  ```powershell
  pyinstaller build_windows.spec --clean --noconfirm
  ```
- [ ] **ビルド完了確認**: エラーなしでビルドが完了
- [ ] **実行ファイル生成確認**: dist/PDF2PPTX_Converter.exe の生成を確認

### 📊 ビルド結果検証
- [ ] **ファイルサイズ確認**: 実行ファイルサイズが妥当（<100MB推奨）
- [ ] **依存関係確認**: 必要なDLLがすべて含まれている
- [ ] **起動テスト**: 実行ファイルが正常に起動する

---

## 🧪 テスト実行段階

### 🔍 基本機能テスト
- [ ] **アプリケーション起動**: GUI が正常に表示される
- [ ] **フォルダ選択**: ファイル選択ダイアログが動作する
- [ ] **PDF読み込み**: サンプルPDFファイルを正常に認識する
- [ ] **PNG変換テスト**: PDF → PNG変換が正常に動作する
- [ ] **PPTX変換テスト**: PDF → PPTX変換が正常に動作する

### 🔧 設定機能テスト
- [ ] **スケール設定**: 変換時のスケール倍率設定が反映される
- [ ] **回転機能**: 自動回転機能が正常に動作する
- [ ] **出力先確認**: 入力ファイルと同じフォルダに出力される
- [ ] **エラーハンドリング**: 不正なファイル選択時の適切なエラー表示

### 🚨 ストレステスト
- [ ] **大容量PDF**: 大きなPDFファイル（50ページ以上）の処理
- [ ] **複数ファイル**: フォルダ内の複数PDFファイルの一括処理
- [ ] **長時間動作**: メモリリークがないことを確認
- [ ] **異常系テスト**: 破損したPDFファイルの処理

---

## 📦 配布パッケージ作成段階

### 🗂️ パッケージ構造作成
- [ ] **配布フォルダ作成**: release/PDF2PNG_Windows_vX.X/ 構造を作成
- [ ] **実行ファイルコピー**: PDF2PPTX_Converter.exe をコピー
- [ ] **README作成**: Windows用のユーザーガイドを作成
- [ ] **サンプルファイル**: テスト用のサンプルPDFを追加

### 📄 ドキュメント準備
- [ ] **インストール手順**: Windows用のセットアップ手順書
- [ ] **使用方法説明**: 基本的な操作手順
- [ ] **システム要件**: 動作環境の明記
- [ ] **トラブルシューティング**: よくある問題と解決方法

### 🗜️ 圧縮とパッケージング
- [ ] **PowerShellスクリプト実行**: create_windows_package.ps1 を実行
  ```powershell
  .\scripts\create_windows_package.ps1 -Version "2.0" -CreateZip
  ```
- [ ] **ZIP作成確認**: 配布用ZIPファイルの生成確認
- [ ] **パッケージサイズ確認**: ファイルサイズが妥当であることを確認

---

## 🔒 セキュリティ・品質確認段階

### 🛡️ セキュリティチェック
- [ ] **ウイルススキャン**: Windows Defenderで実行ファイルをスキャン
- [ ] **他社製品スキャン**: 可能であれば複数のウイルス対策ソフトでチェック
- [ ] **SmartScreen対策**: Windows SmartScreenでの動作確認
- [ ] **実行権限確認**: 管理者権限なしで実行可能であることを確認

### 📊 品質保証
- [ ] **複数Windows環境**: 異なるWindows 11環境でのテスト
- [ ] **クリーンPC**: 開発環境以外のPCでの動作確認
- [ ] **日本語環境**: 日本語Windows環境での文字化けチェック
- [ ] **パフォーマンス**: メモリ使用量・処理速度の測定

### 📝 最終確認
- [ ] **バージョン情報**: ファイルプロパティに正しいバージョン情報
- [ ] **デジタル署名**: 可能であればコード署名を実施
- [ ] **配布準備完了**: 最終的な配布パッケージの動作確認

---

## 🚀 配布・デプロイ段階

### 🌐 アップロード準備
- [ ] **ハッシュ値計算**: SHA256ハッシュ値を計算・記録
  ```powershell
  Get-FileHash .\release\PDF2PNG_Windows_v2.0.zip -Algorithm SHA256
  ```
- [ ] **リリースノート**: 変更履歴とリリース情報を準備
- [ ] **ダウンロードサイト**: 配布先の準備（GitHub Releases等）

### 📢 配布後フォロー
- [ ] **ユーザーサポート**: 問い合わせ対応体制の確認
- [ ] **フィードバック収集**: ユーザーからの報告受付体制
- [ ] **アップデート計画**: 今後の改善・アップデート予定

---

## 🆘 緊急時チェックリスト

### ❗ ビルドエラー時
- [ ] **エラーメッセージ確認**: PyInstallerの詳細ログを確認
- [ ] **依存関係再確認**: requirements.txt の内容を確認
- [ ] **仮想環境リセット**: 仮想環境を作り直し
- [ ] **Pythonバージョン変更**: 異なるPythonバージョンでの試行

### ❗ 動作エラー時
- [ ] **Visual C++ Redistributable**: 再配布可能パッケージのインストール
- [ ] **DLL依存関係**: 不足DLLの特定と追加
- [ ] **パス問題**: 実行時パスの確認
- [ ] **権限問題**: 実行権限・書き込み権限の確認

### ❗ セキュリティ警告時
- [ ] **除外設定**: ウイルス対策ソフトの例外設定
- [ ] **SmartScreen回避**: 実行時の警告回避方法の案内
- [ ] **デジタル署名**: コード署名証明書の取得検討
- [ ] **配布方法変更**: HTTPS・信頼できるサイトからの配布

---

**📋 チェックリスト完了日**: _______________
**🏗️ ビルド実行者**: _______________
**✅ 最終確認者**: _______________

---

## 🎯 成功の指標

✅ **完全成功**: すべてのチェック項目が完了
⚠️ **部分成功**: 主要機能は動作するが改善の余地あり
❌ **失敗**: 基本機能が動作しない - 再ビルド必要

**目標**: Windows 11環境でエラーなく動作する配布パッケージの作成完了
# CSV2XLSX_IC 利用マニュアル

## 目次

1. [はじめに](#はじめに)
2. [インストール](#インストール)
3. [GUI版の使い方](#gui版の使い方)
4. [CLI版の使い方](#cli版の使い方)
5. [よくある質問](#よくある質問)
6. [エラーと対処法](#エラーと対処法)

## はじめに

CSV2XLSX_ICは、CSVファイルとExcelファイルを相互に変換するためのツールです。
Windows環境で動作し、以下の特徴があります：

- 複数のCSVファイルを1つのExcelファイルにまとめる
- Excelファイルの各シートを個別のCSVファイルに分割する
- 文字コードの自動判別と変換
- GUI（画面操作）とCLI（コマンドライン）の両方に対応

## インストール

### 実行ファイル版（推奨）

1. 配布されたZIPファイルを任意のフォルダに展開します
2. 展開されたフォルダ内の実行ファイルを直接起動できます
   - `CSV2XLSX_GUI.exe`: GUI版
   - `CSV2XLSX_CLI.exe`: CLI版

### Python環境での実行

Python環境がインストールされている場合は、ソースコードから実行できます。

1. Python 3.9以上をインストール
2. コマンドプロンプトで以下を実行：

```cmd
cd CSV2XLSX
pip install -r requirements.txt
```

## GUI版の使い方

### 起動方法

以下のいずれかの方法で起動します：

- `CSV2XLSX_GUI.exe`をダブルクリック
- `GUI起動.bat`をダブルクリック
- コマンドプロンプトから：`python src\main.py`

### 基本操作

#### 1. ファイルの選択

**方法A: ドラッグ＆ドロップ**
1. 変換したいファイルを選択
2. アプリケーション画面の「ファイル選択エリア」にドラッグ＆ドロップ

**方法B: ファイル選択ダイアログ**
1. 「ファイルを選択」ボタンをクリック
2. ファイル選択ダイアログから変換したいファイルを選択
3. 「開く」をクリック

#### 2. 変換の種類

**CSV→Excel変換**
- 複数のCSVファイルを選択可能
- 各CSVファイルが1つのExcelファイルの別シートになります
- シート名は元のCSVファイル名から自動生成

**Excel→CSV変換**
- 1つのExcelファイルのみ選択
- 各シートが個別のCSVファイルとして出力
- ファイル名は「元のファイル名_シート名.csv」形式

#### 3. オプション設定

**文字コード設定（Excel→CSV変換時）**
- UTF-8: 標準的な文字コード（推奨）
- Shift_JIS: 日本語Windows環境での互換性重視

#### 4. 変換実行

1. 「変換実行」ボタンをクリック
2. プログレスバーで進捗を確認
3. 完了メッセージが表示されたら「OK」をクリック

### 画面説明

```
┌─────────────────────────────────────────┐
│  CSV2XLSX_IC                            │
├─────────────────────────────────────────┤
│ ┌─ファイル選択エリア─────────────────┐ │
│ │                                     │ │
│ │ ここにファイルをドラッグ＆ドロップ    │ │
│ │                                     │ │
│ │ [ファイルを選択...]                  │ │
│ └───────────────────────────────────┘ │
│                                         │
│ ┌─出力設定─────────────────────────┐ │
│ │ 出力情報: [自動生成パス]            │ │
│ └───────────────────────────────────┘ │
│                                         │
│ ┌─オプション───────────────────────┐ │
│ │ 文字コード: [UTF-8 ▼]              │ │
│ └───────────────────────────────────┘ │
│                                         │
│                      [変換実行]         │
│                                         │
│ [■■■■■□□□□□] 50%                   │
│                                         │
│ ステータス: 準備完了                     │
└─────────────────────────────────────────┘
```

## CLI版の使い方

### 基本構文

```cmd
CSV2XLSX_CLI.exe <コマンド> [オプション]
```

### コマンド一覧

#### csv2xlsx - CSV→Excel変換

```cmd
CSV2XLSX_CLI.exe csv2xlsx <CSVファイル1> [CSVファイル2...] -o <出力Excelファイル>
```

**例：**
```cmd
# 単一CSVファイルの変換
CSV2XLSX_CLI.exe csv2xlsx data.csv -o output.xlsx

# 複数CSVファイルの統合
CSV2XLSX_CLI.exe csv2xlsx sales.csv customers.csv products.csv -o all_data.xlsx
```

#### xlsx2csv - Excel→CSV変換

```cmd
CSV2XLSX_CLI.exe xlsx2csv <Excelファイル> -o <出力ディレクトリ> [-e <文字コード>]
```

**例：**
```cmd
# UTF-8で出力（デフォルト）
CSV2XLSX_CLI.exe xlsx2csv data.xlsx -o ./csv_output

# Shift_JISで出力
CSV2XLSX_CLI.exe xlsx2csv data.xlsx -o ./csv_output -e shift_jis
```

### バッチ処理の例

複数ファイルの一括処理用バッチファイル例：

```batch
@echo off
rem 全CSVファイルを1つのExcelに統合
CSV2XLSX_CLI.exe csv2xlsx *.csv -o all_data.xlsx

rem 複数のExcelファイルをCSVに変換
for %%f in (*.xlsx) do (
    CSV2XLSX_CLI.exe xlsx2csv "%%f" -o "./%%~nf_csv"
)
```

## よくある質問

### Q1: どのような形式のCSVファイルに対応していますか？

A: 以下の形式に対応しています：
- カンマ区切り（標準）
- ダブルクォート、シングルクォートで囲まれたフィールド
- 改行を含むフィールド
- UTF-8、Shift_JISエンコーディング

### Q2: Excelファイルのサイズ制限はありますか？

A: 以下の制限があります：
- 最大行数：1,048,576行
- 最大列数：16,384列
- メモリ使用量：最大1GB程度
- 推奨ファイルサイズ：100MB以下

### Q3: シート名はどのように決まりますか？

A:
- CSV→Excel変換時：元のCSVファイル名（拡張子なし）
- 31文字を超える場合は自動的に切り詰め
- 重複する場合は自動的に番号を付加

### Q4: 日付や数値の形式は保持されますか？

A:
- CSV→Excel：文字列として読み込み、Excelが自動判定
- Excel→CSV：表示形式のまま文字列として出力

## エラーと対処法

### エラー: ファイルが見つかりません

**原因：**
- ファイルパスが間違っている
- ファイルが移動または削除された

**対処法：**
- ファイルの存在を確認
- パスにスペースが含まれる場合は""で囲む

### エラー: アクセスが拒否されました

**原因：**
- ファイルが他のプログラムで開かれている
- 書き込み権限がない

**対処法：**
- Excelなど他のプログラムを閉じる
- 管理者権限で実行
- 別の保存先を指定

### エラー: メモリ不足

**原因：**
- ファイルサイズが大きすぎる
- 他のプログラムがメモリを使用

**対処法：**
- 不要なプログラムを終了
- ファイルを分割して処理
- PCを再起動

### エラー: 文字化けが発生

**原因：**
- 文字コードの不一致

**対処法：**
- Excel→CSV変換時は適切な文字コードを選択
- 元ファイルの文字コードを確認
- テキストエディタで文字コードを変換

## サポート

問題が解決しない場合は、以下の情報と共に管理者にお問い合わせください：

1. エラーメッセージの全文
2. 使用しているファイル名とサイズ
3. 実行した操作の手順
4. Windows版（Windows 10/11）

---

最終更新日：2025年1月